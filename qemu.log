Starting MelloOS in QEMU...

Using preset: Single CPU (SMP disabled)
Configuration:
  CPUs: 1
  KVM: disabled

Booting in UEFI mode (EDK2)...
2025-10-21 01:01:58.979 qemu-system-x86_64[32139:4173252] Failure on line 687 in function id scheduleApplicationNotification(LSNotificationCode, NSWorkspaceNotificationCenter *): noErr == _LSModifyNotification(notificationID, 1, &code, 0, NULL, NULL, NULL)
2025-10-21 01:02:00.452 qemu-system-x86_64[32139:4173353] Connection Invalid error for service com.apple.hiservices-xpcservice.
2025-10-21 01:02:00.452 qemu-system-x86_64[32139:4173252] Error received in message reply handler: Connection invalid
[2J[01;01H[=3h[2J[01;01H[2J[01;01H[=3h[2J[01;01H[2J[01;01H[=3h[2J[01;01HBdsDxe: loading Boot0001 "UEFI QEMU DVD-ROM QM00005 " from PciRoot(0x0)/Pci(0x1F,0x2)/Sata(0x2,0xFFFF,0x0)
BdsDxe: starting Boot0001 "UEFI QEMU DVD-ROM QM00005 " from PciRoot(0x0)/Pci(0x1F,0x2)/Sata(0x2,0xFFFF,0x0)
[2J[01;01H[01;01H[2J[01;01H[01;01H[KERNEL] MelloOS starting...
[KERNEL] Getting framebuffer response...
[KERNEL] Getting framebuffer...
[KERNEL] Creating framebuffer instance...
[KERNEL] Clearing screen...
[KERNEL] Initializing memory management...
[KERNEL] Initializing ACPI...
[ACPI] RSDP found at 0xffff80007f77e014
[ACPI] RSDP validated, revision: 2
[ACPI] MADT found at 0x7f778000
[ACPI] Local APIC address: 0xfee00000
[ACPI] CPU: processor_id=0, apic_id=0, enabled=true
[ACPI] I/O APIC: id=0, address=0xfec00000, gsi_base=0
[ACPI] Skipping MADT entry type 2
[ACPI] Skipping MADT entry type 2
[ACPI] Skipping MADT entry type 2
[ACPI] Skipping MADT entry type 2
[ACPI] Skipping MADT entry type 2
[ACPI] Skipping MADT entry type 4
[SMP] CPUs detected: 1 (apic_ids=[0])
[SMP] Enabled CPUs: 1
[KERNEL] Initializing BSP Local APIC...
[SMP] BSP online (apic_id=0)
[KERNEL] Initializing BSP per-CPU data...
ABCXYEFGHIJKLD[PERCPU] BSP per-CPU data initialized (cpu_id=0, apic_id=0)
[KERNEL] Calibrating APIC timer...
[APIC] LAPIC timer frequency: 1005200000 Hz
[KERNEL] Initializing BSP APIC timer...
[APIC] core0 timer @100Hz
[KERNEL] Initializing SMP (bringing up Application Processors)...
[SMP] Initializing SMP...
[SMP] Copying trampoline to 0x8000 (320 bytes)
[SMP] Creating identity mapping for 0x0000-0x9FFF
[SMP] Identity mapped 0x0-0x1FFFFF using 2MB huge page
[SMP] Identity mapping created for low memory
[SMP] DEBUG: PML4[256] (higher-half) = 0x0000000079FF0027
[SMP] Higher-half kernel mappings verified
[SMP] DEBUG: CR3 = 0x000000007E0DD000
[SMP] DEBUG: Entry point = 0xFFFFFFFF8000F610
[SMP] Found 0 APs to initialize
[SMP] SMP initialization complete: 0 CPUs online
[SMP] Successfully initialized 0 CPUs
[KERNEL] Writing message to screen...
[KERNEL] Initializing IPC subsystem...
[IPC] Initializing IPC subsystem...
[IPC] Created 16 system ports (0-15)
[IPC] IPC subsystem initialized!
[KERNEL] Initializing scheduler...
[SCHED] INFO: Initializing scheduler...
[SCHED] INFO: Created idle task (id 0)
[SCHED] INFO: Scheduler initialized!
[KERNEL] Initializing timer interrupt...
[TIMER] Setting up IDT...
[TIMER] Syscall handler registered at vector 0x80 (DPL=3)
[TIMER] IDT loaded successfully
[TIMER] Registering APIC timer handler at vector 0x20...
[TIMER] APIC timer handler registered successfully
[IPI] Registering RESCHEDULE_IPI handler at vector 0x30...
[IPI] RESCHEDULE_IPI handler registered successfully
[KERNEL] ========================================
[KERNEL] Phase 4 Integration Tests
[KERNEL] ========================================
[KERNEL] Spawning Test 7.1: Priority scheduling test...
[SCHED] Enqueued task 1 to CPU 0 (runqueue size: 1)
[SCHED] INFO: Spawned task 1: Test-High (priority: High)
[SCHED] Enqueued task 2 to CPU 0 (runqueue size: 2)
[SCHED] INFO: Spawned task 2: Test-Normal (priority: Normal)
[SCHED] Enqueued task 3 to CPU 0 (runqueue size: 3)
[SCHED] INFO: Spawned task 3: Test-Low (priority: Low)
[KERNEL] Spawning Test 7.2: Sleep/wake test...
[SCHED] Enqueued task 4 to CPU 0 (runqueue size: 4)
[SCHED] INFO: Spawned task 4: Test-Sleep (priority: Normal)
[KERNEL] Spawning Test 7.3: Syscall integration test...
[SCHED] Enqueued task 5 to CPU 0 (runqueue size: 5)
[SCHED] INFO: Spawned task 5: Test-Syscall (priority: Normal)
[KERNEL] Spawning Test 7.4: IPC integration test...
[SCHED] Enqueued task 6 to CPU 0 (runqueue size: 6)
[SCHED] INFO: Spawned task 6: IPC-Sender (priority: Normal)
[SCHED] Enqueued task 7 to CPU 0 (runqueue size: 7)
[SCHED] INFO: Spawned task 7: IPC-Receiver (priority: Normal)
[KERNEL] Spawning Test 7.5: IPC stress test...
[SCHED] Enqueued task 8 to CPU 0 (runqueue size: 8)
[SCHED] INFO: Spawned task 8: Stress-Ping (priority: Normal)
[SCHED] Enqueued task 9 to CPU 0 (runqueue size: 9)
[SCHED] INFO: Spawned task 9: Stress-Pong (priority: Normal)
[KERNEL] Loading Test 7.6: Init process (end-to-end test)...
[INIT] Loading init process (Phase 6.3 - ELF + User Mode)...
[INIT] Init ELF binary size: 6944 bytes
[INIT] Init ELF binary address: 0xffffffff80018670
[SCHED] Enqueued task 10 to CPU 0 (runqueue size: 10)
[SCHED] INFO: Spawned task 10: init (priority: High)
[SCHED] INFO: Created process 1 with task 10 (init)
[INIT] Init process scheduled (pid=1, task_id=10)
[KERNEL] Yielding once to schedule init process immediately...
[SCHED] [core0] First switch â†’ Task 1 (Test-High) [priority: High]
[SCHED] [core0] Switch #0 â†’ Task 2 (Test-Normal)
[TEST-7.1] NORMAL priority task executing (count: 0)
[SYSCALL] Task 2 invoked SYS_SLEEP (id=2)
[SCHED] [core0] Switch #1 â†’ Task 3 (Test-Low)
[SCHED] [core0] Switch #2 â†’ Task 4 (Test-Sleep)
[TEST-7.2] Sleep/wake test iteration 0
[TEST-7.2] Going to sleep for 50 ticks...
[SYSCALL] Task 4 invoked SYS_SLEEP (id=2)
[SCHED] [core0] Switch #3 â†’ Task 5 (Test-Syscall)
[TEST-7.3] Syscall integration test iteration 0
[SYSCALL] Task 5 invoked SYS_WRITE (id=0)
Testing sys_write from integration test
[SYSCALL] Task 5 SYS_WRITE returned: 40
[SCHED] [core0] Switch #4 â†’ Task 6 (IPC-Sender)
[TEST-7.4] Sender: Sending message #0 to port 1
[SYSCALL] Task 6 invoked SYS_IPC_SEND (id=3)
[SCHED] Preemption disabled
[IPC] Sent 4 bytes to port 1
[SYSCALL] Task 6 SYS_IPC_SEND returned: 0
[TEST-7.4] Sender: Message sent successfully
[SCHED] [core0] Switch #5 â†’ Task 7 (IPC-Receiver)
[TEST-7.4] Receiver: Waiting for message on port 1...
[SYSCALL] Task 7 invoked SYS_IPC_RECV (id=4)
[IPC] Received 4 bytes from port 1
[SYSCALL] Task 7 SYS_IPC_RECV returned: 4
[SCHED] [core0] Switch #6 â†’ Task 8 (Stress-Ping)
[SYSCALL] Task 8 invoked SYS_IPC_SEND (id=3)
[IPC] Sent 4 bytes to port 10
[SYSCALL] Task 8 SYS_IPC_SEND returned: 0
[SYSCALL] Task 8 invoked SYS_IPC_RECV (id=4)
[IPC] Task 8 blocking on port 11 (no messages)
[SCHED] [core0] Switch #7 â†’ Task 9 (Stress-Pong)
[SYSCALL] Task 9 invoked SYS_IPC_RECV (id=4)
